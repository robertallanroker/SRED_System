<openerp>

    <!-- UI VIEWS -->
    <data>



        <record model="ir.ui.view"  id="sred_system.my_sred_form">
            <field name="name">SRED Work</field>
            <field name="model">sred_system.claim_project</field>
            <field name="arch" type="xml">
                <form string="SRED Work">

                    <Header>
                        <field name="claim_status" string="Claim Status" widget="statusbar" clickable="True" />
                    </Header>
                    <sheet string="SRED Work">
                            <div>
                                <field name="saved_company_logo" widget="image" class="oe_avatar" attrs="{'invisible':[('partner_id','=',False)]}"/>
                            </div>
                            <div>
                                 <field name="user_image" widget="image" class="oe_avatar" attrs="{'invisible':[('user_id','=',False)]}"/>
                            </div>

                            <div class="oe_right">
                                <div class = "oe_button_box">
                                   <div>
                                        <button type="object"
                                            name="calendar_button_pressed"
                                            class="oe_stat_button"
                                            icon="fa-calendar"
                                            string="Meetings"
                                            attrs="{'invisible':[('user_id','=',False)]}">
                                        </button>

                                        <button type="object"
                                                name="link_button_pressed"
                                                class= "oe_stat_button"
                                                icon="fa-chain"
                                                attrs="{'invisible':[('user_id','=',False)]}">
                                        </button>

                                        <button  class = "oe_stat_button"
                                                 name = "attachment_tree_view"
                                                 type = "object"
                                                 icon = "fa-files-o" >
                                            <field string = "Documents" name = "doc_count" widget = "statinfo" />
                                        </button>

                                        <button type=  "object"
                                                name = "open_website_action"
                                                class= "oe_stat_button"
                                                icon = "fa-globe"
                                                attrs= "{'invisible':[('user_id','=',False)]}">
                                            <field string="website" name = "website" widget="statinfo"/>
                                        </button>

                                    </div>

                                </div>

                            </div>

                        <group>

                           <group attrs = "{'invisible':[('partner_id','=',False)]}">
                               <field name = "cra_year_end" string="CRA Year End" attrs="{'required': [('partner_id','!=',False)]}"/>
                               <field name = "cra_bin" string="CRA BIN" attrs="{'required': [('partner_id','!=',False)]}"/>
                               <field name = "contracted_service" string = "Contract Label" />
                               <field name = "contract_no" string = "Contract#" attrs="{'readonly': True, 'invisible': [('contracted_service','=',False)]}" />
                           </group>

                           <group>
                               <field name = "file_no" string="File No" readonly="1"/>
                               <field name = "refund" widget="monetary"/>
                               <field name = "fee" widget="monetary"/>
                           </group>

                        </group>

                        <group>
                            <group string="Claim">
                                <field name="name" placeholder="Title of the work" string="Claim Work Title" />
                                <field name="claim_type" string="claim type" />
                                <field name="tax_years" widget="many2many_tags"/>
                                <field name="website" widget="url" attrs="{'invisible':[('partner_id','=',False)]}" />
                            </group>
                            <group string="Assigned">
                                    <field name="partner_id" string="customer" />
                                    <field name="user_id" />
                                    <field name="folder_group" string="Folder group" />
                                    <field name="folder" string="Folder"/>
                                    <field name="link_email" string = "correspondence" />
                            </group>
                        </group>

                        <notebook>
                            <page string = "Processing">
                                <group>
                                    <field name="glip_processing_status" string="Greenlight" widget="statusbar" clickable="True"/>
                                    <field name="cra_processing_status"  string="CRA" widget="statusbar" clickable="True"/>
                                    <field name="work_processing_status" string="Work" widget="statusbar" clickable="True"/>
                                </group>
                            </page>
                            <page string="Estimations">
                                       <field name="estimations" string="Estimations">
                                           <tree editable="true">
                                               <field name="e_date" string="date"/>
                                               <field name="person" string="person"/>
                                               <field name="refund" widget="monetary"/>
                                               <field name="fee" widget="monetary"/>
                                           </tree>
                                       </field>
                            </page>
                            <page string = "Roles">
                                <field name="work_roles" string="Project Roles" widget="one2many" >
                                    <tree editable="true">
                                        <button class="oe_stat_button" name="user_login_button" type="object" string="portal"/>
                                        <field name="work_scope" string="Scope"/>
                                        <field name="work_person" string="Assigned"/>
                                        <field name="work_types" placeholder="Roles" widget="many2many_tags" />
                                        <field name="work_functions" placeholder="Functions" widget="many2many_tags"/>
                                    </tree>
                                </field>ÃŸ
                            </page>
                            <page string="Task List">
                                <field name="task_ids" string="Task Items" widget="one2many" >
                                    <tree editable="true" decoration-danger="date_deadline and (date_deadline&lt;current_date)">
                                        <!--field name="sequence"/-->
                                        <!--button class="oe_stat_button" name="user_login_button" type="object" string="login"/-->
                                        <field name="sequence" string="#" />
                                        <field name="completed" string="completed?" widget="checkbox" help="Check off when completed work"/>
                                        <field name="assigned_to" string="assigned"/>
                                        <field name="name" string="task item"/>
                                        <field name="date_deadline" string="deadline"/>
                                    </tree>
                                </field>
                            </page>
                            <page string="Note Pad">
                                <field name="notes" type="html"/>
                            </page>
                        </notebook>
                        <field name="estimated_fee" attrs="{'invisible':True}"/>
                        <field name="estimated_refund" attrs="{'invisible':True}"/>
                    </sheet>
                   <div class="oe_chatter">

                       <field name="message_follower_ids" widget="mail_followers"/>
                       <field name="message_ids" widget="mail_thread" />

                   </div>

                </form>
            </field>
        </record>

        <record model="ir.ui.view" id="sred_system.tree_of_sred_claims">
            <field name="name">List Claim Folders</field>
            <field name="model">sred_system.claim_project</field>
            <field name="type">tree</field>
            <field name="arch" type="xml">
                <tree editable="0">
                    <field name="claim_type" string="claim type" />
                    <field name="partner_id" string="client" />
                    <field name="name" string="Claim" />
                    <field name="tax_years" string="Tax" widget="many2many"/>
                    <field name="estimated_fee" widget="monetary" string="Fee"/>
                    <field name="estimated_refund" widget="monetary" string="Refund"/>
                    <field name="claim_status" string="Claim"/>
                    <field name="work_processing_status" string="Work"/>
                    <field name="glip_processing_status" string="Processing"/>
                    <field name="cra_processing_status" string="CRA"/>
                </tree>
            </field>
        </record>

    </data>


    <!-- CLAIMS -->
    <data>

         <record id="sred_system.search_claims" model="ir.ui.view">
            <field name="name">Search Claims</field>
            <field name="model">sred_system.claim_project</field>
            <field name="arch" type="xml">
                <search string="sred claims">

                    <field name="user_id"/>
                    <field name="partner_id"/>

                    <group expand="1" string="Group By">
                        <filter string="assigned person" name="assigned-to-me-group" context="{'group_by':'user_id'}"/>
                        <filter string="Company" name="my-company" context="{'group_by':'partner_id'}"/>
                    </group>

                </search>
            </field>
        </record>

        <record model="ir.actions.act_window" id="sred_system.action_claims">
            <field name="name">SRED Claim</field>
            <field name="res_model">sred_system.claim_project</field>
            <field name="view_mode">tree,form</field>
            <field name="search_view_id" ref="sred_system.search_claims"/>
            <field name="context">{'search_default_assigned-to-me':1}</field>
        </record>

    </data>

    <data>

        <record id="sred_system.project_folder_search" model="ir.ui.view">
            <field name="name">Search Folders</field>
            <field name="model">sred_system.claim_project</field>
            <field name="arch" type="xml">
                <search string="sred claims">
                    <field name="user_id"/>
                    <field name="folder"/>
                    <field name="folder_group"/>
                    <field name="claim_status"/>
                    <field name="partner_id"/>
                    <field name="cra_processing_status"/>
                    <field name="glip_processing_status"/>
                    <field name="work_processing_status"/>
                    <filter string="Assigned to me" name="assigned-to-me" domain="[('user_id','=',uid)]"/>
                    <separator/>
                    <filter string="Active claims" name="active-claim" domain="['|', ('claim_status','=','New'),
                                                                                ('claim_status','=','Open')]" />
                    <filter string="New claim" name="new-claim" domain="[('claim_status','=','New')]" />
                    <filter string="Open claim" name="open-claim" domain="[('claim_status','=','Open')]" />
                    <filter string="Closed claim" name="closed-claim" domain="[('claim_status','=','Closed')]" />
                    <group expand="1" string="Group By">
                        <filter string="folder groups" name="my-folders-group" context="{'group_by':'folder_group'}" />
                        <filter string="folders" name="my-folders" context="{'group_by':'folder'}" />
                        <filter string="Claim type" name="claim_type" context="{'group_by':'partner_id'}"/>
                        <seperator/>
                        <filter string="Company" name="my-company" context="{'group_by':'partner_id'}"/>
                        <seperator/>
                        <filter string="Work" name="work" context="{'group_by':'work_processing_status'}"/>
                        <filter string="CRA" name="cra" context="{'group_by':'cra_processing_status'}"/>
                        <filter string="Processing" name="processing" context="{'group_by':'glip_processing_status'}"/>
                        <seperator/>
                        <filter string="assigned person" name="assigned-to-me-group" context="{'group_by':'user_id'}"/>
                    </group>

                </search>
            </field>
        </record>


        <record model="ir.actions.act_window" id="sred_system.action_project_folder">
            <field name="name">folders search</field>
            <field name="res_model">sred_system.claim_project</field>
            <field name="view_mode">tree,form</field>
            <field name="search_view_id" ref="sred_system.project_folder_search"/>
            <field name="context">{'search_default_my-folders-group':1,
                                    'search_default_my-folders':1,
                                    'search_default_assigned-to-me':1}'
                                    'search_default_active-claim':1)</field>
        </record>




    </data>


    <!-- TASKS -->
    <data>


        <record model="ir.ui.view"  id="sred_system.form_tasks">
            <field name="name">SRED Tasks Entry</field>
            <field name="model">sred_system.sred_project_tasks</field>
            <field name="type">form</field>
            <field name="arch" type="xml">
                <form string="SRED Claim Tasks">
                    <Header>
                        <field name="stagetype" string="Stage Type" widget="statusbar" clickable="True" />
                    </Header>
                    <sheet>
                       <field name="processing_status" string="Processing" widget="statusbar" clickable="True"/>
                       <group>
                            <field name="name" string = "Task Name"  />
                       </group>
                       <group>
                           <field name="date_deadline"/>
                           <field name="assigned_to"/>
                           <field name="completed"/>
                       </group>
                        <notebook>
                            <page string="Description">
                                <field name="description" widget="html" />
                            </page>
                        </notebook>
                    </sheet>
                    <div class="oe_chatter">
                       <field name="message_follower_ids" widget="mail_followers"/>
                       <field name="message_ids" widget="mail_thread" />
                    </div>
                </form>
            </field>
        </record>

        <record id="sred_system.calendar_claim_tasks" model="ir.ui.view">
            <field name="name">Calendar of Tasks</field>
            <field name="model">sred_system.sred_project_tasks</field>
            <field name="type">calendar</field>
            <field name="arch" type="xml">
                <calendar color="color_index" date_start="date_deadline" string="Tasks">
                    <field name="name"/>
                    <field name="assigned_to"/>
                    <field name="completed" />
                </calendar>
            </field>
        </record>

        <record model="ir.ui.view"  id="sred_system.view_tasks">
            <field name="name">Set claim types</field>
            <field name="model">sred_system.sred_project_tasks</field>
            <field name="type">tree</field>
            <field name="arch" type="xml">
                <tree default_order="sequence">
                    <field name="partner_id" string="company"/>
                    <field name="task_id" string = "claim project" />
                    <field name="stagetype" string ="stage"/>
                    <field name="processing_status" string="status"/>
                    <field name="completed" string="completed?" widget="checkbox" help="Check off when completed work"/>
                    <field name="assigned_to" string="assigned"/>
                    <field name="name" string="task item"/>
                    <field name="date_deadline" string="deadline"/>
                </tree>
            </field>
        </record>



        <record id="sred_system.search_tasks" model="ir.ui.view">
            <field name="name">search tasks</field>
            <field name="model">sred_system.sred_project_tasks</field>
            <field name="arch" type="xml">
                <search string="sred tasks">
                    <field name="partner_id" string="Company"/>
                    <field name="assigned_to" string="Assigned"/>
                    <field name="completed" string="Completed"/>
                    <filter string="Assigned to me" name="filter-tasks-assigned-to-me" domain="[('assigned_to','=',uid)]"/>
                    <separator/>
                    <filter string="Not Completed" name="filter-tasks-not-completed" domain="[('completed','=',False)]"/>
                    <filter string="Completed" name="filter-tasks-completed" domain="[('completed','=',False)]"/>
                    <group expand="1" string="Group By">
                        <filter string="Assigned Person" name="group-tasks-assigned-to-me" context="{'group_by':'assigned_to'}"/>
                        <seperator/>
                    </group>
                </search>
            </field>
        </record>


        <record model="ir.actions.act_window" id="sred_system.action_claims_tasks">
            <field name="name">search tasks by list</field>
            <field name="res_model">sred_system.sred_project_tasks</field>
            <field name="view_mode">tree,calendar,form</field>
            <field name="search_view_id" ref="sred_system.search_tasks"/>
            <field name="context">{'search_default_filter-tasks-not-completed':1,
                                    'search_default_filter-tasks-assigned-to-me':1} </field>
        </record>


    </data>


  </openerp>